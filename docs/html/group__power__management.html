<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STC15W408AS library: Power management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">STC15W408AS library<span id="projectnumber">&#160;0.8.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Power management</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga89e1b35bd6cbaf15cc0d33631acac076"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__management.html#ga89e1b35bd6cbaf15cc0d33631acac076">idle</a>()&#160;&#160;&#160;(bit_set(PCON, SBIT0))</td></tr>
<tr class="memdesc:ga89e1b35bd6cbaf15cc0d33631acac076"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set MCU idle mode.  <a href="group__power__management.html#ga89e1b35bd6cbaf15cc0d33631acac076">More...</a><br /></td></tr>
<tr class="separator:ga89e1b35bd6cbaf15cc0d33631acac076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e0d38ad57d2078db65a84e857f5e5b6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__management.html#ga1e0d38ad57d2078db65a84e857f5e5b6">power_down</a>()</td></tr>
<tr class="memdesc:ga1e0d38ad57d2078db65a84e857f5e5b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set MCU power down mode.  <a href="group__power__management.html#ga1e0d38ad57d2078db65a84e857f5e5b6">More...</a><br /></td></tr>
<tr class="separator:ga1e0d38ad57d2078db65a84e857f5e5b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad065f706bff0883cb08354bdfe211cdf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__management.html#gad065f706bff0883cb08354bdfe211cdf">wakeup_timer_init</a> (uint16_t ticks)</td></tr>
<tr class="memdesc:gad065f706bff0883cb08354bdfe211cdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init and run wakeup timer.  <a href="group__power__management.html#gad065f706bff0883cb08354bdfe211cdf">More...</a><br /></td></tr>
<tr class="separator:gad065f706bff0883cb08354bdfe211cdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga337c44a8acbd7295f76bb63226b3feab"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__power__management.html#ga337c44a8acbd7295f76bb63226b3feab">wakeup_timer_internal_clk_freq</a> ()</td></tr>
<tr class="memdesc:ga337c44a8acbd7295f76bb63226b3feab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get wakeup timer internal clock frequency.  <a href="group__power__management.html#ga337c44a8acbd7295f76bb63226b3feab">More...</a><br /></td></tr>
<tr class="separator:ga337c44a8acbd7295f76bb63226b3feab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Functions and data structures related for MCU power management </p><dl class="section author"><dt>Author</dt><dd>Michael Golovanov </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga89e1b35bd6cbaf15cc0d33631acac076" name="ga89e1b35bd6cbaf15cc0d33631acac076"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89e1b35bd6cbaf15cc0d33631acac076">&#9670;&nbsp;</a></span>idle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define idle</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(bit_set(PCON, SBIT0))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set MCU idle mode. </p>
<p >Shuts off clock to CPU, but clock to Timers, Interrupts, Serial Ports, and Analog Peripherals are still active. The CPU status is preserved in its entirety: the RAM, Stack Pointer, Program Counter, Program Status Word, Accumulator, and all other registers maintain their data during Idle. The port pins hold the logical states they had at the time Idle was activated. <br  />
 </p>

</div>
</div>
<a id="ga1e0d38ad57d2078db65a84e857f5e5b6" name="ga1e0d38ad57d2078db65a84e857f5e5b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e0d38ad57d2078db65a84e857f5e5b6">&#9670;&nbsp;</a></span>power_down</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define power_down</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{                               \</div>
<div class="line">    bit_set(PCON, SBIT1);       \</div>
<div class="line">    __asm__(<span class="stringliteral">&quot;nop&quot;</span>);             \</div>
<div class="line">    __asm__(<span class="stringliteral">&quot;nop&quot;</span>);             \</div>
<div class="line">    __asm__(<span class="stringliteral">&quot;nop&quot;</span>);             \</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Set MCU power down mode. </p>
<p >In the Stop/Power-Down mode, the on-chip oscillator and the Flash memory are stopped in order to minimize power consumption. Only the power-on circuitry will continue to draw power during Stop/Power-Down. The contents of on-chip RAM and SFRs are maintained. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gad065f706bff0883cb08354bdfe211cdf" name="gad065f706bff0883cb08354bdfe211cdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad065f706bff0883cb08354bdfe211cdf">&#9670;&nbsp;</a></span>wakeup_timer_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wakeup_timer_init </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>ticks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init and run wakeup timer. </p>
<p >Wakeup time is calculated as (10^6/wakeup_timer_internal_clock_frequency) * 16 * ticks</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__power__management.html#ga337c44a8acbd7295f76bb63226b3feab" title="Get wakeup timer internal clock frequency.">wakeup_timer_internal_clk_freq()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ticks</td><td>uint16_t wakeup timer ticks count </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga337c44a8acbd7295f76bb63226b3feab" name="ga337c44a8acbd7295f76bb63226b3feab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga337c44a8acbd7295f76bb63226b3feab">&#9670;&nbsp;</a></span>wakeup_timer_internal_clk_freq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t wakeup_timer_internal_clk_freq </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get wakeup timer internal clock frequency. </p>
<p >wakeup timer internal clock frequency after MCU powerup is placed in RAM __idata 0xf8-0xf9 adresses.</p>
<p >By default SDCC compiler generate firmware part that before main() call clear RAM and 0xf8-0xf9 contains 0x00 values.</p>
<p >To avoid memory clearing implement empty <br  />
 void _mcs51_genRAMCLEAR() {} routine. Otherwise routine call return result 0x00.</p>
<p >Default value is 0x8c0a = 35850Hz.</p>
<dl class="section return"><dt>Returns</dt><dd>uint16_t wakeup timer internal clock frequency from 0xf8-0xf9 RAM </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
